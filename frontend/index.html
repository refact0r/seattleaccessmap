<!doctype html>
<html>
	<head>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>AccessMapSeattle</title>
		<link
			rel="stylesheet"
			href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
		/>
		<link
			rel="stylesheet"
			href="https://fonts.googleapis.com/css2?family=Geist+Mono:wght@400&display=swap"
		/>
		<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
		<link rel="stylesheet" href="style.css" />
		<script src="https://unpkg.com/leaflet.heat@0.2.0/dist/leaflet-heat.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.4/dist/chart.umd.min.js"></script>
	</head>

	<body>
		<!-- ── Top Navigation ── -->
		<nav class="top-nav">
			<div class="brand">accessMapSeattle</div>
			<div class="nav-tabs">
				<button class="nav-tab active" data-view="explore">
					Explore
				</button>
				<button class="nav-tab" data-view="route">Route</button>
				<button class="nav-tab" data-view="analytics">Analytics</button>
			</div>
		</nav>

		<!-- ── Main Content ── -->
		<div class="content">
			<!-- ── Left Panel ── -->
			<div class="left-panel">
				<!-- ═══ EXPLORE VIEW ═══ -->
				<div class="view-content active" id="view-explore">
					<div class="panel-section">
						<h3>Overview</h3>
						<div class="stats-row">
							<div class="stat-box">
								<div class="value" id="stat-total">--</div>
								<div class="label">Barriers</div>
							</div>
							<div class="stat-box">
								<div class="value" id="stat-visible">--</div>
								<div class="label">Visible</div>
							</div>
							<div class="stat-box">
								<div class="value" id="stat-avg-sev">--</div>
								<div class="label">Avg Severity</div>
							</div>
						</div>
					</div>

					<div class="panel-section">
						<h3>Filter</h3>

						<div class="filter-group">
							<label>Types</label>
							<div class="checkbox-grid">
								<label class="checkbox-item">
									<input
										type="checkbox"
										data-type="CurbRamp"
										checked
									/>
									Curb Ramp
								</label>
								<label class="checkbox-item">
									<input
										type="checkbox"
										data-type="NoCurbRamp"
										checked
									/>
									No Curb Ramp
								</label>
								<label class="checkbox-item">
									<input
										type="checkbox"
										data-type="NoSidewalk"
										checked
									/>
									No Sidewalk
								</label>
								<label class="checkbox-item">
									<input
										type="checkbox"
										data-type="Obstacle"
										checked
									/>
									Obstacle
								</label>
								<label class="checkbox-item">
									<input
										type="checkbox"
										data-type="SurfaceProblem"
										checked
									/>
									Surface Problem
								</label>
								<label class="checkbox-item">
									<input
										type="checkbox"
										data-type="Other"
										checked
									/>
									Other
								</label>
							</div>
						</div>

						<div class="filter-group">
							<label>Severity Range</label>
							<div class="severity-range">
								<span id="sev-min-val">0</span>
								<input
									type="range"
									id="sev-min"
									min="0"
									max="10"
									value="0"
									step="0.5"
								/>
								<input
									type="range"
									id="sev-max"
									min="0"
									max="10"
									value="10"
									step="0.5"
								/>
								<span id="sev-max-val">10</span>
							</div>
						</div>

						<div class="filter-group">
							<div class="toggle-row">
								<label class="toggle-label"
									>Hide Temporary</label
								>
								<input type="checkbox" id="hide-temp" />
							</div>
						</div>
					</div>

					<div class="panel-section">
						<h3>Fix Priorities</h3>
						<div id="priorities-list" class="priorities-list"></div>
					</div>
				</div>

				<!-- ═══ ROUTE VIEW ═══ -->
				<div class="view-content" id="view-route">
					<div class="panel-section">
						<h3>Set Points</h3>
						<div class="click-mode-buttons">
							<button
								id="set-origin-btn"
								class="click-mode-btn origin"
							>
								Set Origin
							</button>
							<button
								id="set-destination-btn"
								class="click-mode-btn destination"
							>
								Set Destination
							</button>
						</div>
						<div class="input-group">
							<label>Origin</label>
							<div class="input-row">
								<input
									type="number"
									id="start-lat"
									placeholder="Lat"
									step="0.0001"
									value="47.6551"
								/>
								<input
									type="number"
									id="start-lng"
									placeholder="Lng"
									step="0.0001"
									value="-122.3046"
								/>
							</div>
						</div>
						<div class="input-group">
							<label>Destination</label>
							<div class="input-row">
								<input
									type="number"
									id="end-lat"
									placeholder="Lat"
									step="0.0001"
									value="47.6305"
								/>
								<input
									type="number"
									id="end-lng"
									placeholder="Lng"
									step="0.0001"
									value="-122.3566"
								/>
							</div>
						</div>
						<div class="examples">
							<p><strong>Examples:</strong></p>
							<p>
								<a onclick="setExample1()">UW → Queen Anne</a>
							</p>
							<p>
								<a onclick="setExample2()">UW → Capitol Hill</a>
							</p>
						</div>
					</div>

					<div class="panel-section">
						<h3>Accessibility Tolerance</h3>
						<div class="slider-group">
							<div class="slider-container">
								<input
									type="range"
									id="tolerance-slider"
									class="slider"
									min="0"
									max="100"
									value="50"
									step="1"
								/>
							</div>
							<div class="slider-labels">
								<span>Max accessibility</span>
								<span>Standard</span>
								<span>Fastest route</span>
							</div>
						</div>
						<button id="calculate-btn" class="btn-primary">
							Calculate Route
						</button>
						<div id="status-message"></div>
					</div>

					<div id="route-results" class="panel-section is-hidden">
						<h3>Route Comparison</h3>
						<div id="route-content"></div>
					</div>
				</div>

				<!-- ═══ ANALYTICS VIEW ═══ -->
				<div class="view-content" id="view-analytics">
					<div class="panel-section">
						<h3>Data Insights</h3>
						<div id="analytics-container">
							<div class="analytics-loading">
								<div class="spinner"></div>
								<p>Loading analytics...</p>
							</div>
						</div>
					</div>
				</div>
			</div>

			<!-- ── Map ── -->
			<div class="map-container">
				<div id="map"></div>

				<!-- Legend Overlay -->
				<div class="legend-stack" id="legend-stack">
					<div class="map-overlay legend legend-base" id="legend-severity">
						<div class="legend-title">Adjusted Severity</div>
						<div class="legend-row">
							<span class="legend-min">0</span>
							<div class="legend-bar"></div>
							<span class="legend-max">10</span>
						</div>
					</div>
					<div
						class="map-overlay legend legend-priorities is-hidden"
						id="legend-priorities"
					>
						<div class="legend-title">Fix Priority Impact</div>
						<div class="legend-row">
							<span class="legend-min">Low</span>
							<div class="legend-bar legend-bar-priority"></div>
							<span class="legend-max">High</span>
						</div>
					</div>
				</div>

				<!-- Layer Toggles Overlay -->
				<div class="map-overlay layer-toggles">
					<div class="layer-toggle">
						<input type="checkbox" id="toggle-barriers" checked />
						<label for="toggle-barriers">Barrier Points</label>
					</div>
					<div class="layer-toggle">
						<input type="checkbox" id="toggle-heatmap" />
						<label for="toggle-heatmap">Severity Heatmap</label>
					</div>
					<div class="layer-toggle">
						<input type="checkbox" id="toggle-clusters" />
						<label for="toggle-clusters">Hotspot Clusters</label>
					</div>
					<div class="layer-toggle">
						<input type="checkbox" id="toggle-priorities" />
						<label for="toggle-priorities">Fix Priorities</label>
					</div>
				</div>
			</div>
		</div>

		<script type="module" src="app.js"></script>
	</body>
</html>
